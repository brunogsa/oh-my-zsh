#!/bin/bash

# usage: echo "..." | anonymize-txt.sh |  grep -Eo '...' | sort | uniq -c | sort -rn

function anonymize-txt() {
  sed -E '
    s/[0-9]{5}-?[0-9]{3}/<CEP>/g
    s/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/<UUID>/g
    s/[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\.[0-9]+)?(Z|[+-][0-9]{2}:[0-9]{2})?/ISO_TIMESTAMP/g
    s/[0-9]{4}-[0-9]{2}-[0-9]{2}/<DATE>/g
    s/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/<IPv4>/g
    s/[0-9]{3}\.[0-9]{3}\.[0-9]{3}-[0-9]{2}/<CPF>/g
    s/[0-9]{2}\.[0-9]{3}\.[0-9]{3}\/[0-9]{4}-[0-9]{2}/<CNPJ>/g
    s/\b[0-9]+\b/<NUMBER>/g
    s/\b[0-9a-f]{32,}\b/<HASH>/g
  '
}
